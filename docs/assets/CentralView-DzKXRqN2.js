import{u as R,r as u,j as e}from"./index-D7y7nnVM.js";import{T as w}from"./Timer-CMoL8hHr.js";function k(){var x;const{snapshot:a,timeLeft:j,actions:c,clientId:m}=R(),n=!!a.code,[d,b]=u.useState(a.stationsCount??5),[o,N]=u.useState(a.roundDurationSec??300),i=a.state==="WAITING",r=a.state==="RUNNING",h=a.state==="ENDED"&&(a.timeLeft??0)>0,s=a.centralClientId===m,y=n&&i&&s;async function f(){try{await c.centralCreate(d,o)}catch(t){alert((t==null?void 0:t.code)??"Create failed")}}async function C(){try{await c.centralUpdate(d,o)}catch(t){alert((t==null?void 0:t.code)??"Update failed")}}async function p(t){try{await c.centralDelete(t)}catch(l){alert((l==null?void 0:l.code)??"Delete failed")}}async function g(){try{await c.centralTogglePause()}catch(t){alert((t==null?void 0:t.code)??"Pause/Resume failed")}}async function v(){try{await c.centralReset()}catch(t){alert((t==null?void 0:t.code)??"Reset failed")}}return e.jsxs("div",{className:"card space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-2xl font-semibold",children:["Central ‚Äî ",n?`Room ${a.code}`:"No room yet"]}),n?e.jsxs("button",{onClick:()=>p(r&&s?!0:void 0),className:"bg-red-600 hover:bg-red-500 disabled:opacity-50",disabled:!s,title:s?void 0:"Only the room creator (Central) can delete this room",children:["Delete Room",r?" (force)":""]}):null]}),e.jsxs("div",{className:"flex flex-wrap gap-3 items-end",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm",children:"Stations"}),e.jsx("input",{type:"number",min:1,value:d,onChange:t=>b(Number(t.target.value)),disabled:!s||!i,title:s?i?void 0:"Change only in WAITING":"Only Central can change"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm",children:"Duration (sec)"}),e.jsx("input",{type:"number",min:10,value:o,onChange:t=>N(Number(t.target.value)),disabled:!s||!i,title:s?i?void 0:"Change only in WAITING":"Only Central can change"})]}),n?e.jsx("button",{disabled:!y,onClick:C,children:"Update Config"}):e.jsx("button",{onClick:f,children:"Create Room"}),n&&e.jsx("button",{onClick:g,disabled:!s||!(r||h),title:s?void 0:"Only Central can control",className:"bg-amber-600 hover:bg-amber-500 disabled:opacity-50",children:r?"Pause":h?"Resume":"Pause"}),n&&e.jsx("button",{onClick:v,disabled:!s,title:s?void 0:"Only Central can control",className:"bg-slate-600 hover:bg-slate-500 disabled:opacity-50",children:"Reset"}),e.jsxs("div",{className:"ml-auto",children:[e.jsx(w,{timeLeft:j??a.timeLeft}),e.jsxs("div",{className:"text-sm opacity-70",children:["State: ",a.state??"-"]})]})]}),n&&e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"opacity-70",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left",children:"Station"}),e.jsx("th",{children:"Owner"}),e.jsx("th",{children:"Ready"}),e.jsx("th",{children:"Conn"})]})}),e.jsx("tbody",{children:(x=a.stations)==null?void 0:x.map(t=>{var l;return e.jsxs("tr",{className:"border-t border-slate-700",children:[e.jsxs("td",{className:"py-1 text-left",children:["#",t.id]}),e.jsx("td",{className:"text-center truncate max-w-[160px]",children:((l=t.ownerClientId)==null?void 0:l.slice(0,8))??"-"}),e.jsx("td",{className:"text-center",children:t.ready?"‚úÖ":"‚¨ú"}),e.jsx("td",{className:"text-center",children:t.connected?"üü¢":"‚ö´"})]},t.id)})})]}),e.jsxs("div",{className:"text-xs opacity-60 space-y-1",children:[e.jsx("div",{children:"‚Ä¢ Config ‡πÅ‡∏Å‡πâ‡πÑ‡∏î‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏≠‡∏ô WAITING ‚Ä¢ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏£‡∏≠‡∏ö‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ó‡∏∏‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡∏û‡∏£‡πâ‡∏≠‡∏°"}),e.jsxs("div",{children:["‚Ä¢ ‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠: ",e.jsx("span",{className:"font-mono",children:(m??"").slice(0,8)||"-"})," ","/ Central Owner:"," ",e.jsx("span",{className:"font-mono",children:(a.centralClientId??"").slice(0,8)||"-"})]}),!s&&e.jsx("div",{className:"text-amber-300",children:"* ‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà Central ‡∏Ç‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏µ‡πâ ‚Äî ‡∏õ‡∏∏‡πà‡∏°‡∏ñ‡∏π‡∏Å‡∏õ‡∏¥‡∏î‡πÑ‡∏ß‡πâ"})]})]})]})}export{k as default};
